(()=>{"use strict";var e,t,r,o,s={520:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IFRAME_COMMS_MESSAGE_TYPE=t.DASHBOARD_UI_FILTER_CONFIG_URL_PARAM_KEY=void 0,t.IFRAME_COMMS_MESSAGE_TYPE="__embedded_comms__",t.DASHBOARD_UI_FILTER_CONFIG_URL_PARAM_KEY={visible:"show_filters",expanded:"expand_filters"}},659:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.REFRESH_TIMING_BUFFER_MS=t.MIN_REFRESH_WAIT_MS=t.DEFAULT_TOKEN_EXP_MS=void 0,t.getGuestTokenRefreshTiming=function(e){const t=(0,o.jwtDecode)(e),r=new Date(/[^0-9\.]/g.test(t.exp)?t.exp:1e3*parseFloat(t.exp));return("Invalid Date"!==r.toString()?Math.max(n,r.getTime()-Date.now()):i)-s};var o=r(278);const s=t.REFRESH_TIMING_BUFFER_MS=5e3,n=t.MIN_REFRESH_WAIT_MS=1e4,i=t.DEFAULT_TOKEN_EXP_MS=3e5},347:(e,t,r)=>{t.u=async function({id:e,supersetDomain:t,mountPoint:r,fetchGuestToken:i,dashboardUiConfig:a,debug:d=!1,iframeTitle:c="Embedded Dashboard",iframeSandboxExtras:h=[]}){function l(...t){d&&console.debug(`[superset-embedded-sdk][dashboard ${e}]`,...t)}function u(){let e=0;return a&&(a.hideTitle&&(e+=1),a.hideTab&&(e+=2),a.hideChartControls&&(e+=8)),e}l("embedding"),t.endsWith("/")&&(t=t.slice(0,-1));const[m,p]=await Promise.all([i(),async function(){return new Promise((n=>{const i=document.createElement("iframe"),m=a?{uiConfig:`${u()}`}:void 0,p=a?.filters||{},g=Object.keys(p),f={...m,...Object.fromEntries(g.map((e=>[o.DASHBOARD_UI_FILTER_CONFIG_URL_PARAM_KEY[e],p[e]]))),...a?.urlParams},b=Object.keys(f).length?"?"+new URLSearchParams(f).toString():"";i.sandbox.add("allow-same-origin"),i.sandbox.add("allow-scripts"),i.sandbox.add("allow-presentation"),i.sandbox.add("allow-downloads"),i.sandbox.add("allow-forms"),i.sandbox.add("allow-popups"),h.forEach((e=>{i.sandbox.add(e)})),i.addEventListener("load",(()=>{const e=new MessageChannel,r=e.port1,a=e.port2;i.contentWindow.postMessage({type:o.IFRAME_COMMS_MESSAGE_TYPE,handshake:"port transfer"},t,[a]),l("sent message channel to the iframe"),n(new s.Switchboard({port:r,name:"superset-embedded-sdk",debug:d}))})),i.src=`${t}/embedded/${e}${b}`,i.title=c,r.replaceChildren(i),l("placed the iframe")}))}()]);return p.emit("guestToken",{guestToken:m}),l("sent guest token"),setTimeout((async function e(){const t=await i();p.emit("guestToken",{guestToken:t}),setTimeout(e,(0,n.getGuestTokenRefreshTiming)(t))}),(0,n.getGuestTokenRefreshTiming)(m)),{getScrollSize:()=>p.get("getScrollSize"),unmount:function(){l("unmounting"),r.replaceChildren()},getDashboardPermalink:e=>p.get("getDashboardPermalink",{anchor:e}),getActiveTabs:()=>p.get("getActiveTabs")}};var o=r(520),s=r(207),n=r(659)},207:(e,t,r)=>{r.r(t),r.d(t,{Switchboard:()=>s,default:()=>n});var o=function(e){return e.GET="get",e.REPLY="reply",e.EMIT="emit",e.ERROR="error",e}(o||{});class s{constructor(e){this.port=void 0,this.name="",this.methods={},this.incrementor=1,this.debugMode=void 0,this.isInitialised=void 0,e&&this.init(e)}init(e){if(this.isInitialised)return void this.logError("already initialized");const{port:t,name:r="switchboard",debug:s=!1}=e;this.port=t,this.name=r,this.debugMode=s,t.addEventListener("message",(async e=>{this.log("message received",e);const t=e.data;if(function(e){return e.switchboardAction===o.GET}(t))this.port.postMessage(await this.getMethodResult(t));else if(function(e){return e.switchboardAction===o.EMIT}(t)){const{method:e,args:r}=t,o=this.methods[e];o&&o(r)}})),this.isInitialised=!0}async getMethodResult({messageId:e,method:t,args:r}){const s=this.methods[t];if(null==s)return{switchboardAction:o.ERROR,messageId:e,error:`[${this.name}] Method "${t}" is not defined`};try{const t=await s(r);return{switchboardAction:o.REPLY,messageId:e,result:t}}catch(r){return this.logError(r),{switchboardAction:o.ERROR,messageId:e,error:`[${this.name}] Method "${t}" threw an error`}}}defineMethod(e,t){this.methods[e]=t}get(e,t=void 0){return new Promise(((r,s)=>{if(!this.isInitialised)return void s(new Error("Switchboard not initialised"));const n=this.getNewMessageId(),i=e=>{const t=e.data;if(t.messageId===n)if(this.port.removeEventListener("message",i),function(e){return e.switchboardAction===o.REPLY}(t))r(t.result);else{const e=function(e){return e.switchboardAction===o.ERROR}(t)?t.error:"Unexpected response message";s(new Error(e))}};this.port.addEventListener("message",i),this.port.start();const a={switchboardAction:o.GET,method:e,messageId:n,args:t};this.port.postMessage(a)}))}emit(e,t=void 0){if(!this.isInitialised)return void this.logError("Switchboard not initialised");const r={switchboardAction:o.EMIT,method:e,args:t};this.port.postMessage(r)}start(){this.isInitialised?this.port.start():this.logError("Switchboard not initialised")}log(...e){this.debugMode&&console.debug(`[${this.name}]`,...e)}logError(...e){console.error(`[${this.name}]`,...e)}getNewMessageId(){return`m_${this.name}_${this.incrementor++}`}}const n=new s},497:(e,t,r)=>{r.a(e,(async(e,t)=>{try{var o=r(347);const e=await fetch("http://localhost:8085/api/v1/superset/token"),s=await e.text(),n="http://192.168.0.133:8089";(0,o.u)({id:"2538840d-34af-492e-a71c-0dea9e90e56a",supersetDomain:n,mountPoint:document.getElementById("superset-container"),fetchGuestToken:()=>s,dashboardUiConfig:{hideTitle:!0}}),t()}catch(e){t(e)}}),1)},278:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.jwtDecode=t.InvalidTokenError=void 0;class r extends Error{}t.InvalidTokenError=r,r.prototype.name="InvalidTokenError",t.jwtDecode=function(e,t){if("string"!=typeof e)throw new r("Invalid token specified: must be a string");t||(t={});const o=!0===t.header?0:1,s=e.split(".")[o];if("string"!=typeof s)throw new r(`Invalid token specified: missing part #${o+1}`);let n;try{n=function(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return function(e){return decodeURIComponent(atob(e).replace(/(.)/g,((e,t)=>{let r=t.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r})))}(t)}catch(e){return atob(t)}}(s)}catch(e){throw new r(`Invalid token specified: invalid base64 for part #${o+1} (${e.message})`)}try{return JSON.parse(n)}catch(e){throw new r(`Invalid token specified: invalid json for part #${o+1} (${e.message})`)}}}},n={};function i(e){var t=n[e];if(void 0!==t)return t.exports;var r=n[e]={exports:{}};return s[e](r,r.exports,i),r.exports}e="function"==typeof Symbol?Symbol("webpack queues"):"__webpack_queues__",t="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",r="function"==typeof Symbol?Symbol("webpack error"):"__webpack_error__",o=e=>{e&&e.d<1&&(e.d=1,e.forEach((e=>e.r--)),e.forEach((e=>e.r--?e.r++:e())))},i.a=(s,n,i)=>{var a;i&&((a=[]).d=-1);var d,c,h,l=new Set,u=s.exports,m=new Promise(((e,t)=>{h=t,c=e}));m[t]=u,m[e]=e=>(a&&e(a),l.forEach(e),m.catch((e=>{}))),s.exports=m,n((s=>{var n;d=(s=>s.map((s=>{if(null!==s&&"object"==typeof s){if(s[e])return s;if(s.then){var n=[];n.d=0,s.then((e=>{i[t]=e,o(n)}),(e=>{i[r]=e,o(n)}));var i={};return i[e]=e=>e(n),i}}var a={};return a[e]=e=>{},a[t]=s,a})))(s);var i=()=>d.map((e=>{if(e[r])throw e[r];return e[t]})),c=new Promise((t=>{(n=()=>t(i)).r=0;var r=e=>e!==a&&!l.has(e)&&(l.add(e),e&&!e.d&&(n.r++,e.push(n)));d.map((t=>t[e](r)))}));return n.r?c:i()}),(e=>(e?h(m[r]=e):c(u),o(a)))),a&&a.d<0&&(a.d=0)},i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i(497)})();